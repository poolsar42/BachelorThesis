\documentclass[a4paper,12pt]{article}

\usepackage{cmap}		
\usepackage[utf8]{inputenc}			
\usepackage[english,russian]{babel}
\usepackage{framed}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{wrapfig}
\usepackage{lipsum}
\usepackage{listings}
\usepackage{color}
\usepackage{indentfirst}
\usepackage{times}
\usepackage{textcomp}


\definecolor{mygray}{rgb}{0.4,0.4,0.4}
\definecolor{mygreen}{rgb}{0,0.8,0.6}
\definecolor{myorange}{rgb}{1.0,0.4,0}

\lstdefinestyle{customc}{
  belowcaptionskip=1\baselineskip,
  breaklines=true,
  frame=L,
  xleftmargin=\parindent,
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{green!40!black},
  commentstyle=\itshape\color{purple!40!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
  numbers=left,
  numbersep=13pt,
  numberstyle=\small\color{mygray},
}
\lstset{escapechar=@,style=customc}
\linespread{1.6}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\begin{document}

\input{title.tex}

\newpage
\section{Аннотация}

Бактериофаги (фаги) - это вирусы, которые избирательно поражают бактериальные клетки. Такая специфика обусловлена
зависимостью фага от клеточного механизма хозяина, который нужен фагу для репликации и биосинтеза вирусных компонентов.
Пример такой зависимости  можно привести для фага Т4. Во время транскрипции, ранняя конкуренция за РНК-полимеразу хозяина
позволяет вирусу полностью захватить механизм репликации путем сигма-присвоения(sigma appropriation) [1]. Недавно
показали[2], что фаги, которые заражают цианобактерии, кодируют ген фотосинтеза. Причём транскрипция этого гена реагирует
на те же условия окружающей среды, что и ген, который кодируется у хозяина. Из этого можно предположить, что существует
связь между регуляторными элементами фага и регуляторными элементами их хозяина. Это поможет лучше предсказывать
взаимоотношения фаг-хозяин.

\newpage
\tableofcontents



\newpage
\section{Введение}

    В одной статье были собраны результаты разных исследований, касающихся взаимоотношений фага T4 и его хоста – E. Coli.
    В этих работах было показано, как ведёт себя фаг, который внедряется в бактерию.
	У фага Т4 нет собственных РНК-полимераз, поэтому он использует РНК-полимеразы хоста для транскрипции. Но почему РНК
	полимераза хоста должна сразу транскрибировать именно с ДНК Т4? Не должна. Но всё же обнаружили, что некоторая часть
	ДНК фага транскрибируется РНК-полимеразой хоста сразу. Эту часть транскрипции назвали ранней транскрипцией фага. На
	этом слайде можно видеть, почему эта ранняя транскрипция просходит. Здесь обозначены разные мотивы промоторов ДНК
	фага (посередине – ранняя, снизу - промежуточная) и хоста (сверху). Эти мотивы, которые находятся в промоторе,
	называются вышестоящими регуляторными элементами. Как видно, в промоторе ранней транскрипции регуляторные элементы
	между фагом и хостом совпадают, и выше -35 участка, что позволяет РНК полимеразе цепляться за ДНК фага также хорошо,
	как за ДНК хоста.  Всё, что до мотива TGn совпадает у всех промоторов. MotA Box в промоторе промежуточной
	транскрипции нужен для зацепки белка, который способствует промежуточной транскрипции. Вкратце, что там просходит: в
	этот момент с РНК, транскрибировавшейся от фага (в ранней транскрипции), транслируются белки, которые модифицируют
	РНК-полимеразы хозяина таким образом, что далее начинают транскрибироваться только ДНК фага. В том числе в начальной
	транскрипции ещё образуется белок MotA, который позволяет ДНК прикрепиться к модифицированной РНК-полимеразе. После
	чего с этой ДНК начинает транскрибироваться РНК. Этот этап уже называют промежуточной транскрипцией. Этот процесс
	присвоения РНК-полимеразы хозяина называют сигма присвоением. Ещё раз. Проиcходит это так:

	В самом начале транслируются белки, которые глушат РНК-полимеразу
	Вместе с этим транслируются белки, которые позволяют при заглушенной полимиразе транскрибироваться ДНК фага на этой
	полимеразе, они садятся на ДНК фага
	Таким образом фаг полностью захватывает РНК-полимеразу хозяина
	Рассмотри ещё один интересный случай для нас. Ещё в одной статье авторы смотрели, как ведут себя транкриптомы фагов и
	их хозяев (цианобактерий в этом случае) в зависимости от интенстивности света, которым они светили. При маленькой
	интенсивности транскриптомы делились в среднем поровну, но при бОльшей интенсивности среднее число РНК фагов было
	намного больше, чем у цианобактерий. Авторы решили посмотреть, что это за участок РНК, который так сильно возрастает
	у фага при сильном свете. Они обнаружили, что это участок РНК, ответственный за белок psbA, который оказался общим у
	фага и его хозяина. Авторы предположили, что это вполне возможно, если фаги позаимствовали гены у хозяев в ходе
	рекомбинации.

\newpage
\section{Цель и задачи} \label{sec:code}

Эти статьи – хорошие примеры, но они не единственные в своём роде. Нам стали интересны такие события, и в нашей работе
мы предположили, что такие схожие вышестоящие регуляторные участки в ДНК фагов и их хостов могут встречаться не только у
цианобактерий и их фагов и T4 с E. Coli, а у всех фагов и их хостов.
В том числе, мы посчитали, что у многих фагов и их хозяев могут встречаться общие белки. Таким образом, если мы сможем
установить взаимоотношения фагов и их хозяинов, мы в будущем сможем прогнозировать отношения фагов и каких-либо хостов.

\newpage
\section{Обзор литературы} \label{sec:math}


\newpage
\section{Материалы и Методы} \label{sec:code}
\subsection{Программные средства}
\begin{itemize}
    \item Virus-Host DB - База данных Virus-Host организует данные о взаимоотношениях между вирусами и их хостами,
    представленные в виде пар идентификаторов таксономии NCBI для вирусов и их хостов. База данных Virus-Host охватывает
    вирусы с полными геномами, хранящимися в 1) NCBI/RefSeq и 2) GenBank, номера присоединения которых указаны в геномах
    EBI. Информация о хосте собирается из RefSeq, GenBank (в свободном текстовом формате), UniProt, ViralZone и вручную
    курируется с дополнительной информацией, полученной в результате опросов литературы. \cite{virus-host}
    
    \item GeneMarkS-2 - программное обеспечение для поиска генов внутри геномов. \cite{lomsad}
    
    \item NCBI Entrez Programming Utilities - программное обеспечение, набор из восьми серверных программ, которые
    обеспечивают стабильный интерфейс с системой запросов и баз данных Entrez в Национальном центре биотехнологической
    информации (NCBI) \cite{entrez}
    
    \item Biopython - набор свободно доступных инструментов для биологических вычислений, написанных на Python
    международной командой разработчиков. \cite{biopython}
    
    \item The MEME Suite - программное обеспечение для поиска новых, нераскрытых мотивов (повторяющихся паттернов
    фиксированной длины) в последовательностях. МЕМ разбивает паттерны переменной длины на два или более отдельных
    мотива. \cite{bailey}
    
    \item Python 3.9.4 - среда для запуска скриптов формата *.py \cite{python}
    
    \item Jupyter Notebook -веб-приложение с открытым исходным кодом, которое позволяет создавать и обмениваться
    документами, содержащими живой код, уравнения, визуализации и повествовательный текст. Использование включает в себя:
    очистку и преобразование данных, численное моделирование, статистическое моделирование, визуализацию данных, машинное
    обучение и многое другое. \cite{jupyter}
    
    \item Скрипты отсюда \(https://github.com/poolsar42/phages-and-hosts\) - подумать, что про них написать!
    \cite{github}
    
    \item \(Fasta\_merge.ipynb\) - скрипт для объединения регуляторных областей хозяина и его фагов в один файл.
    \item \(Hosts\_upstream\_regions.ipynb\) - скрипт для выделения регуляторных областей.
    \item \(Proteins\_formation.ipynb\) - скрипт для сбора белковых последовтельностей в один файл.
    \item \(Searching\_host\_genomes.ipynb\) - скрипт для выгрузки необходимых к работе геномов хостов.
    \item \(Unpacking.ipynb\) - скрипт для распаковки выгруженных геномов.
    \item \(VH\_tsv\_writer.ipynb\) - скрипт, выписывающий в файл ID хоста и ID прилежащих к нему фагов.
    \item \(Virus\_genes.ipynb\) - скрипт для выгрузки геномов фагов.
    \item \(missing\_phage\_genomes.ipynb\) - скрипт для поиска фагов, для которых GMS2 не находит гены.
    \item \(proteins\_convertation.ipynb \) - скрипт для преобразования \\ ДНК-последовательностей
                                в белковые.
    \item \(regex\_promoter.ipynb \) - скрипт для анализа полученных результатов
    \item \(run\_gms2.py\) - скрипт для поиска генов в геномах
    \item \(tsv\_write.ipynb\) - скрипт для выписывания информации о связи между хостами и фагами в один файл
\end{itemize}

\subsection{Получение общих мотивов}
    \subsubsection{Протокол выгрузки геномов}
    \begin{itemize}
        \item С FTP сервера Virus-Hist DataBase выгрузить файл virushostdb.tsv - в нём содержится информация о связи между фагами и их хостами.
    
        \item Запустить скрипт \(tsv\_write.ipynb\) - выписывает в удобном формате все взаимоотношения между фагами и хостами.
    
      \item Запустить скрипт \(Virus\_genes.ipynb\) - для выгрузки геномов фагов.
        \item Запустить скрипт \(Searching\_host\_genomes.ipynb\) - для выгразки геномов хостов.
        \item Запустить скрипт \(Unpacking.ipynb\).

    \end{itemize}

    \subsubsection{Протокол получение вышестоящих регуляторных регионов}
        \begin{itemize}
            \item Запустить скрипт \(run\_gms2.py\)
            \item Запустить скрипт \(Hosts\_upstream\_regions.ipynb\)
        \end{itemize}
    \subsubsection{Протокол подготовки данных к поиску мотивов}
        \begin{itemize}
            \item Запустить скрипт \(Fasta\_merge.ipynb\)
            \item Запустить MEME Suite с получившимися файлами.
        \end{itemize}

\par{Нам нужно было посмотреть на сходтсва между вышестоящими регуляторными участками у хостов и фагов. Для этого нужно
было посмотреть на геномы хостов и фагов. Мы собрали геномы всех фагов, которые находятся в базе данных Virus-Host DB,
там для каждого фага также был указан или были указаны хосты, к которым он может прикрепиться. Их RefSeq ID. Мы всё
выгрузили с FTP сервера.}

\par{Далее мы выгрузили все геномы хостов с базы данных RefSeq NCBI. Когда у нас были геномы фагов и их хостов, нам было
нужно получить с этих геномов гены. Гены мы находили с помощью Gene-Marks 2. Что хорошо, Gene-Marks 2 также дал позицию
каждого гена в геноме. Каждому гену посчитали его транслирующийся белок, также с помощью Gene-Marks 2. После этого для
каждого гена нашли вышестоящие регуляторные области, длиной в 50 нуклеотидов, которые нужны для посадки РНК-полимераз(?).
Наша гипотеза как раз заключается в том, что эти вышестоящие области у фага и его хозяина для некоторых генов будут
совпадать по некоторым мотивам.}

\par{Мы поработали с последовательностями. Мы выгружали геномы всех фагов и хостов отдельными файлами. Мы предварительно
обработали файлы, достали из них вышестоящие регуляторные области длинной в 50 нуклеотов. Вышестоящие области хоста и
всех фагов, прилегающих к нему, мы закинули в один файл - в этом файле мы и искали общие мотивы.}

\par{Далее проверку на совпадения вышестоящих областей мы засунули все вышестоящие области хоста и его фагов в программу
MEME Suite. Как и ожидалось, мы получили множество профилей, которые были общими у фагов и их хоста. }

\par{Также MEME-Suite для каждого профиля мотива дала нам PFM (Position Frequency Matrix), поэтому у нас была возможность
сравнить сами мотивы между собой. У нас появилась гипотеза, что мотивы фагов, атакующих одного хоста, могут быть также
схожи и как-то коррелировать между собой. Мы решили посмотреть корреляцию 2D массивов - потому что для каждой позиции в
матрице частот у нас было 4 значения - на 4 возможных нуклеотида.}

\newpage
\section{Результаты и Обсуждение}

\newpage
\section{Выводы}


\newpage
\begin{thebibliography}{9}
    \addcontentsline{toc}{section}{\refname}
    \bibitem{virus-host} https://www.genome.jp/virushostdb/ 
    \bibitem{biopython} https://biopython.org/
    \bibitem{python} https://docs.python.org/3/
    \bibitem{jupyter} https://jupyter.org/
    \bibitem{github} https://github.com/poolsar42/phages-and-hosts
    \bibitem{entrez} https://www.ncbi.nlm.nih.gov/books/NBK25501/
    \bibitem{hinton} Hinton D.M. Transcriptional control in the prereplicative phase of T4 development // Virology
    journal. 2010. V. 7. P. 289. https://doi.org/10.1186/1743-422X-7-289
    \bibitem{puxty-evanx} Puxty, R.J., Evans, D.J., Millard, A.D. et al. Energy limitation of cyanophage development:
    implications for marine carbon cycling // ISME J. 2018, 12, 1273–1286. https://doi.org/10.1038/s41396-017-0043-3
    \bibitem{lomsad} Lomsadze, A., Gemayel, K., Tang, S., and Borodovsky, M. Modeling leaderless transcription and
    atypical genes results in more accurate gene prediction in prokaryotes // Genome research,  2018. 28(7), 1079–1089.
    https://doi.org/10.1101/gr.230615.117
    \bibitem{bailey} Bailey, T.L., Johnson, J., Grant, C.E., and Noble, W.S. The MEME Suite // Nucleic acids research,
    2015, 43(W1), W39–W49. https://doi.org/10.1093/nar/gkv416
    \bibitem{ryasik} Ryasik, A., Orlov, M., Zykova, E., Ermak, T., Sorokin, A. Bacterial promoter prediction: Selection
    of dynamic and static physical properties of DNA for reliable sequence classification // 2018
    https://www.worldscientific.com/doi/abs/10.1142/S0219720018400036
    
\end{thebibliography}

\end{document}

\usepackage[english,russian]{babel}